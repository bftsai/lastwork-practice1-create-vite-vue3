import{S as C}from"./sweetalert2-IjaoQ1Xo.js";import{e as W,f as ut,g as K,h as B,i as Q,j as Tt,k as mt,l as ht,_ as Y,o as P,c as w,a as E,w as tt,b as t,m as R,n as D,p as N,F as G,q as nt,s as et,v as at,t as kt,r as O,u as V,x as xt}from"./index-RhPkjOgT.js";import{d as X,s as Mt,c as Ct,l as Nt,z as St,F as Dt,a as Lt,E as Vt,r as Ot,e as $t,i as It,b as Ut}from"./zh_TW-YfJ5mlGx.js";import{L as Bt}from"./Loading-nQKnvIi4.js";var _t={exports:{}},st={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var lt;function Ft(){return lt||(lt=1,function(i,e){(function(a,o){i.exports=o(W(),ut(),K())})(B,function(a,o,s){const c="backdrop",d="fade",u="show",m=`mousedown.bs.${c}`,g={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},p={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class h extends o{constructor(l){super(),this._config=this._getConfig(l),this._isAppended=!1,this._element=null}static get Default(){return g}static get DefaultType(){return p}static get NAME(){return c}show(l){if(!this._config.isVisible){s.execute(l);return}this._append();const y=this._getElement();this._config.isAnimated&&s.reflow(y),y.classList.add(u),this._emulateAnimation(()=>{s.execute(l)})}hide(l){if(!this._config.isVisible){s.execute(l);return}this._getElement().classList.remove(u),this._emulateAnimation(()=>{this.dispose(),s.execute(l)})}dispose(){this._isAppended&&(a.off(this._element,m),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const l=document.createElement("div");l.className=this._config.className,this._config.isAnimated&&l.classList.add(d),this._element=l}return this._element}_configAfterMerge(l){return l.rootElement=s.getElement(l.rootElement),l}_append(){if(this._isAppended)return;const l=this._getElement();this._config.rootElement.append(l),a.on(l,m,()=>{s.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(l){s.executeAfterTransition(l,this._getElement(),this._config.isAnimated)}}return h})}(st)),st.exports}var z={exports:{}};/*!
  * Bootstrap component-functions.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var rt;function pt(){return rt||(rt=1,function(i,e){(function(a,o){o(e,W(),Q(),K())})(B,function(a,o,s,c){const d=(u,m="hide")=>{const g=`click.dismiss${u.EVENT_KEY}`,p=u.NAME;o.on(document,g,`[data-bs-dismiss="${p}"]`,function(h){if(["A","AREA"].includes(this.tagName)&&h.preventDefault(),c.isDisabled(this))return;const n=s.getElementFromSelector(this)||this.closest(`.${p}`);u.getOrCreateInstance(n)[m]()})};a.enableDismissTrigger=d,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})}(z,z.exports)),z.exports}var it={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var ct;function qt(){return ct||(ct=1,function(i,e){(function(a,o){i.exports=o(W(),Q(),ut())})(B,function(a,o,s){const c="focustrap",u=".bs.focustrap",m=`focusin${u}`,g=`keydown.tab${u}`,p="Tab",h="forward",n="backward",l={autofocus:!0,trapElement:null},y={autofocus:"boolean",trapElement:"element"};class k extends s{constructor(b){super(),this._config=this._getConfig(b),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return l}static get DefaultType(){return y}static get NAME(){return c}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),a.off(document,u),a.on(document,m,b=>this._handleFocusin(b)),a.on(document,g,b=>this._handleKeydown(b)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,a.off(document,u))}_handleFocusin(b){const{trapElement:M}=this._config;if(b.target===document||b.target===M||M.contains(b.target))return;const A=o.focusableChildren(M);A.length===0?M.focus():this._lastTabNavDirection===n?A[A.length-1].focus():A[0].focus()}_handleKeydown(b){b.key===p&&(this._lastTabNavDirection=b.shiftKey?n:h)}}return k})}(it)),it.exports}var ot={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var dt;function Rt(){return dt||(dt=1,function(i,e){(function(a,o){i.exports=o(Tt(),Q(),K())})(B,function(a,o,s){const c=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",d=".sticky-top",u="padding-right",m="margin-right";class g{constructor(){this._element=document.body}getWidth(){const h=document.documentElement.clientWidth;return Math.abs(window.innerWidth-h)}hide(){const h=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,u,n=>n+h),this._setElementAttributes(c,u,n=>n+h),this._setElementAttributes(d,m,n=>n-h)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,u),this._resetElementAttributes(c,u),this._resetElementAttributes(d,m)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(h,n,l){const y=this.getWidth(),k=x=>{if(x!==this._element&&window.innerWidth>x.clientWidth+y)return;this._saveInitialAttribute(x,n);const b=window.getComputedStyle(x).getPropertyValue(n);x.style.setProperty(n,`${l(Number.parseFloat(b))}px`)};this._applyManipulationCallback(h,k)}_saveInitialAttribute(h,n){const l=h.style.getPropertyValue(n);l&&a.setDataAttribute(h,n,l)}_resetElementAttributes(h,n){const l=y=>{const k=a.getDataAttribute(y,n);if(k===null){y.style.removeProperty(n);return}a.removeDataAttribute(y,n),y.style.setProperty(n,k)};this._applyManipulationCallback(h,l)}_applyManipulationCallback(h,n){if(s.isElement(h)){n(h);return}for(const l of o.find(h,this._element))n(l)}}return g})}(ot)),ot.exports}/*!
  * Bootstrap modal.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(i,e){(function(a,o){i.exports=o(mt(),W(),Q(),Ft(),pt(),qt(),K(),Rt())})(B,function(a,o,s,c,d,u,m,g){const p="modal",n=".bs.modal",l=".data-api",y="Escape",k=`hide${n}`,x=`hidePrevented${n}`,b=`hidden${n}`,M=`show${n}`,A=`shown${n}`,L=`resize${n}`,I=`click.dismiss${n}`,U=`mousedown.dismiss${n}`,r=`keydown.dismiss${n}`,H=`click${n}${l}`,f="modal-open",T="fade",F="show",Z="modal-static",bt=".modal.show",Et=".modal-dialog",yt=".modal-body",vt='[data-bs-toggle="modal"]',Pt={backdrop:!0,focus:!0,keyboard:!0},wt={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class $ extends a{constructor(_,v){super(_,v),this._dialog=s.findOne(Et,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new g,this._addEventListeners()}static get Default(){return Pt}static get DefaultType(){return wt}static get NAME(){return p}toggle(_){return this._isShown?this.hide():this.show(_)}show(_){this._isShown||this._isTransitioning||o.trigger(this._element,M,{relatedTarget:_}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(f),this._adjustDialog(),this._backdrop.show(()=>this._showElement(_)))}hide(){!this._isShown||this._isTransitioning||o.trigger(this._element,k).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(F),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){o.off(window,n),o.off(this._dialog,n),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new c({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new u({trapElement:this._element})}_showElement(_){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const v=s.findOne(yt,this._dialog);v&&(v.scrollTop=0),m.reflow(this._element),this._element.classList.add(F);const S=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,o.trigger(this._element,A,{relatedTarget:_})};this._queueCallback(S,this._dialog,this._isAnimated())}_addEventListeners(){o.on(this._element,r,_=>{if(_.key===y){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),o.on(window,L,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),o.on(this._element,U,_=>{o.one(this._element,I,v=>{if(!(this._element!==_.target||this._element!==v.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(f),this._resetAdjustments(),this._scrollBar.reset(),o.trigger(this._element,b)})}_isAnimated(){return this._element.classList.contains(T)}_triggerBackdropTransition(){if(o.trigger(this._element,x).defaultPrevented)return;const v=this._element.scrollHeight>document.documentElement.clientHeight,S=this._element.style.overflowY;S==="hidden"||this._element.classList.contains(Z)||(v||(this._element.style.overflowY="hidden"),this._element.classList.add(Z),this._queueCallback(()=>{this._element.classList.remove(Z),this._queueCallback(()=>{this._element.style.overflowY=S},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const _=this._element.scrollHeight>document.documentElement.clientHeight,v=this._scrollBar.getWidth(),S=v>0;if(S&&!_){const q=m.isRTL()?"paddingLeft":"paddingRight";this._element.style[q]=`${v}px`}if(!S&&_){const q=m.isRTL()?"paddingRight":"paddingLeft";this._element.style[q]=`${v}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(_,v){return this.each(function(){const S=$.getOrCreateInstance(this,_);if(typeof _=="string"){if(typeof S[_]>"u")throw new TypeError(`No method named "${_}"`);S[_](v)}})}}return o.on(document,H,vt,function(At){const _=s.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&At.preventDefault(),o.one(_,M,q=>{q.defaultPrevented||o.one(_,b,()=>{m.isVisible(this)&&this.focus()})});const v=s.findOne(bt);v&&$.getInstance(v).hide(),$.getOrCreateInstance(_).toggle(this)}),d.enableDismissTrigger($),m.defineJQueryPlugin($),$})})(_t);var Wt=_t.exports;const Kt=ht(Wt),ft={methods:{showModal(){const i=new Kt(this.$refs.modal,{keyboard:!1});this.modal=i,this.modal.show()},hideModal(){this.tempProduct={},this.$emit("emit-hideModal"),this.modal.hide()}}},Yt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20style='margin:%20auto;%20background-image:%20none;%20display:%20block;%20shape-rendering:%20auto;'%20width='50px'%20height='50px'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%3e%3ccircle%20cx='50'%20cy='50'%20r='32'%20stroke-width='8'%20stroke='%23fe718d'%20stroke-dasharray='50.26548245743669%2050.26548245743669'%20fill='none'%20stroke-linecap='round'%3e%3canimateTransform%20attributeName='transform'%20type='rotate'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='0%2050%2050;360%2050%2050'%3e%3c/animateTransform%3e%3c/circle%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io/%20--%3e%3c/svg%3e",zt="https://ec-course-api.hexschool.io/",Jt="bftsai";X("required",Ot);X("email",$t);X("integer",It);X("regex",Ut);Mt("zh_TW");Ct({generateMessage:Nt({zh_TW:St}),validateOnInput:!0});const jt={data(){return{modal:{},tempProduct:{},imageUrl:"",loading:!1}},props:{product:{type:Object,default(){return{}}},editProduct:{type:Object,default(){return{}}}},components:{VForm:Dt,VField:Lt,ErrorMessage:Vt},mixins:[ft],watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product)),this.imageUrl="";const i=document.querySelector("#imageUpload");i.value=""},editProduct(){this.tempProduct=JSON.parse(JSON.stringify(this.editProduct))}},methods:{isImage(){var i;return this.tempProduct.imageUrl&&((i=this.tempProduct)==null?void 0:i.imagesUrl.length)>=1?!0:"請至少新增兩張產品圖片"},async getImageUrl(i){try{this.loading=!0;const e=i.target.files[0],a=new FormData;a.append("file-to-upload",e);const o=(await this.axios.post(`${zt}v2/api/${Jt}/admin/upload`,a)).data;o.success&&(this.imageUrl=o.imageUrl),this.loading=!1}catch(e){console.log(e.response),this.loading=!1}},addImage(){this.tempProduct.imageUrl?this.tempProduct.imagesUrl.push(this.imageUrl):this.tempProduct.imageUrl=this.imageUrl,this.imageUrl=""},sendProduct(){var i;try{(i=this.tempProduct)!=null&&i.id?(this.tempProduct.is_enabled!==!0&&!this.tempProduct.is_enabled?this.tempProduct.is_enabled=0:this.tempProduct.is_enabled===!0&&(this.tempProduct.is_enabled=1),console.log("path",this.tempProduct),this.$emit("emit-path-product",this.tempProduct)):(this.tempProduct.is_enabled===!0?this.tempProduct.is_enabled=1:this.tempProduct.is_enabled=0,console.log("new",this.tempProduct),this.$emit("emit-post-product",this.tempProduct)),this.tempProduct={}}catch(e){console.log(e)}}},mounted(){}},Gt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static","data-bs-keyboard":"false"},Qt={class:"modal-content border-0"},Xt={class:"modal-header"},Ht=t("h5",{class:"modal-title fs-md-4 fs-6 fw-bold"},"新增產品",-1),Zt={class:"modal-body"},te={class:"row"},ee={class:"col-sm-4"},se={key:0,class:"mb-3"},ie=["src"],oe={class:"mb-3"},ne={for:"imageInput",class:"d-flex flex-column"},ae={class:"mb-3"},le={for:"imageUpload",class:"d-flex flex-column"},re={class:"d-flex align-items-center"},ce=["disabled"],de={key:0,src:Yt,alt:"loading"},ue={key:1,class:"mb-3"},me=["src"],he=["src"],_e={class:"col-sm-8"},pe={class:"mb-3"},fe={for:"title",class:"d-flex flex-column"},ge={class:"row"},be={class:"col-sm-6"},Ee={class:"mb-3"},ye={for:"category",class:"d-flex flex-column"},ve={class:"col-sm-6"},Pe={class:"mb-3"},we={for:"unit",class:"d-flex flex-column"},Ae={class:"row"},Te={class:"col-sm-6"},ke={class:"mb-3"},xe={for:"origin_price",class:"d-flex flex-column"},Me={class:"col-sm-6"},Ce={class:"mb-3"},Ne={for:"price",class:"d-flex flex-column"},Se={class:"mb-3"},De={for:"description",class:"d-flex flex-column"},Le={class:"mb-3"},Ve={for:"content",class:"d-flex flex-column"},Oe={class:"mb-3"},$e={for:"is_enabled",class:"d-flex align-items-center"},Ie=["checked"],Ue={class:"modal-footer"},Be=t("button",{type:"submit",class:"btn btn-primary"},"Save changes",-1);function Fe(i,e,a,o,s,c){const d=O("v-field"),u=O("error-message"),m=O("v-form");return P(),w("div",Gt,[E(m,{class:"modal-dialog modal-xl",onSubmit:c.sendProduct,novalidate:""},{default:tt(({errors:g})=>{var p,h,n,l,y,k,x,b,M,A,L,I,U;return[t("div",Qt,[t("div",Xt,[Ht,t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...r)=>i.hideModal&&i.hideModal(...r))},"X")]),t("div",Zt,[t("div",te,[t("div",ee,[s.imageUrl?(P(),w("div",se,[t("img",{src:s.imageUrl,alt:"主圖照片",class:"object-fit-cover w-100"},null,8,ie)])):R("",!0),t("div",oe,[t("label",ne,[D(" 輸入圖片網址 "),E(d,{name:"image",class:N({"is-invalid":g.image}),id:"imageInput",type:"text",placeholder:"請輸入圖片連結",modelValue:s.imageUrl,"onUpdate:modelValue":e[1]||(e[1]=r=>s.imageUrl=r),disabled:((h=(p=s.tempProduct)==null?void 0:p.imagesUrl)==null?void 0:h.length)>=5,rules:c.isImage},null,8,["class","modelValue","disabled","rules"]),E(u,{name:"image",class:"invalid-feedback"}),t("span",{class:N(["text-danger",{"d-none":((l=(n=s.tempProduct)==null?void 0:n.imagesUrl)==null?void 0:l.length)!==5}])},"上傳照片數量已滿",2)])]),t("div",ae,[t("label",le,[D(" 或 上傳圖片 "),t("div",re,[t("input",{id:"imageUpload",type:"file",disabled:((k=(y=s.tempProduct)==null?void 0:y.imagesUrl)==null?void 0:k.length)>=5,onChange:e[2]||(e[2]=(...r)=>c.getImageUrl&&c.getImageUrl(...r))},null,40,ce),s.loading?(P(),w("img",de)):R("",!0)]),t("span",{class:N(["text-danger",{"d-none":((b=(x=s.tempProduct)==null?void 0:x.imagesUrl)==null?void 0:b.length)!==5}])},"上傳照片數量已滿",2)])]),s.tempProduct.imageUrl?(P(),w("div",ue,[(M=s.tempProduct)!=null&&M.imageUrl?(P(),w("img",{key:0,class:"w-45 me-3 mb-3",src:(A=s.tempProduct)==null?void 0:A.imageUrl,alt:""},null,8,me)):R("",!0),(P(!0),w(G,null,nt(s.tempProduct.imagesUrl,(r,H)=>(P(),w("img",{src:r,alt:"附圖 key",key:"key"+H,class:"w-45 me-3"},null,8,he))),128))])):R("",!0),t("button",{type:"button",class:N(["btn btn-outline-primary w-100",{disabled:((I=(L=s.tempProduct)==null?void 0:L.imagesUrl)==null?void 0:I.length)===5}]),onClick:e[3]||(e[3]=(...r)=>c.addImage&&c.addImage(...r))},"新增圖片",2)]),t("div",_e,[t("div",pe,[t("label",fe,[D(" 標題 "),E(d,{name:"標題",class:N({"is-invalid":g.標題}),id:"title",type:"text",placeholder:"請輸入標題",modelValue:s.tempProduct.title,"onUpdate:modelValue":e[4]||(e[4]=r=>s.tempProduct.title=r),rules:"required"},null,8,["class","modelValue"]),E(u,{name:"標題",class:"invalid-feedback"})])]),t("div",ge,[t("div",be,[t("div",Ee,[t("label",ye,[D(" 分類 "),E(d,{name:"分類",class:N({"is-invalid":g.分類}),id:"category",type:"text",placeholder:"請輸入分類",modelValue:s.tempProduct.category,"onUpdate:modelValue":e[5]||(e[5]=r=>s.tempProduct.category=r),rules:"required"},null,8,["class","modelValue"]),E(u,{name:"分類",class:"invalid-feedback"})])])]),t("div",ve,[t("div",Pe,[t("label",we,[D(" 單位 "),E(d,{name:"單位",class:N({"is-invalid":g.單位}),id:"unit",type:"text",placeholder:"請輸入單位",modelValue:s.tempProduct.unit,"onUpdate:modelValue":e[6]||(e[6]=r=>s.tempProduct.unit=r),rules:"required"},null,8,["class","modelValue"]),E(u,{name:"單位",class:"invalid-feedback"})])])])]),t("div",Ae,[t("div",Te,[t("div",ke,[t("label",xe,[D(" 原價 "),E(d,{name:"原價",class:N({"is-invalid":g.原價}),id:"origin_price",type:"number",placeholder:"請輸入原價",modelValue:s.tempProduct.origin_price,"onUpdate:modelValue":e[7]||(e[7]=r=>s.tempProduct.origin_price=r),rules:"required|integer"},null,8,["class","modelValue"]),E(u,{name:"原價",class:"invalid-feedback"})])])]),t("div",Me,[t("div",Ce,[t("label",Ne,[D(" 售價 "),E(d,{name:"售價",class:N({"is-invalid":g.售價}),id:"price",type:"number",placeholder:"請輸入售價",modelValue:s.tempProduct.price,"onUpdate:modelValue":e[8]||(e[8]=r=>s.tempProduct.price=r),rules:"required|integer"},null,8,["class","modelValue"]),E(u,{name:"售價",class:"invalid-feedback"})])])])]),t("div",Se,[t("label",De,[D(" 產品描述 "),E(d,{name:"產品描述",rules:"required",modelValue:s.tempProduct.description,"onUpdate:modelValue":e[10]||(e[10]=r=>s.tempProduct.description=r)},{default:tt(()=>[et(t("textarea",{name:"產品描述",class:N({"is-invalid":g.產品描述}),id:"description",cols:"30",rows:"3",placeholder:"請輸入產品描述","onUpdate:modelValue":e[9]||(e[9]=r=>s.tempProduct.description=r)},null,2),[[at,s.tempProduct.description]]),E(u,{name:"產品描述",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",Le,[t("label",Ve,[D(" 說明內容 "),E(d,{name:"說明內容",rules:"required",modelValue:s.tempProduct.content,"onUpdate:modelValue":e[12]||(e[12]=r=>s.tempProduct.content=r)},{default:tt(()=>[et(t("textarea",{name:"content",class:N({"is-invalid":g.說明內容}),id:"content",cols:"30",rows:"3",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[11]||(e[11]=r=>s.tempProduct.content=r)},null,2),[[at,s.tempProduct.content]]),E(u,{name:"說明內容",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",Oe,[t("label",$e,[et(t("input",{type:"checkbox",name:"is_enabled",id:"is_enabled",class:"me-2",checked:(U=s.tempProduct)==null?void 0:U.is_enabled,"onUpdate:modelValue":e[13]||(e[13]=r=>s.tempProduct.is_enabled=r)},null,8,Ie),[[kt,s.tempProduct.is_enabled]]),D(" 是否啟用 ")])])])])]),t("div",Ue,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[14]||(e[14]=(...r)=>i.hideModal&&i.hideModal(...r))},"Close"),Be])])]}),_:1},8,["onSubmit"])],512)}const qe=Y(jt,[["render",Fe]]),Re={data(){return{tempProduct:{}}},mixins:[ft],props:{product:{type:Object,default(){return{}}}},watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},methods:{sendProduct(){this.$emit("emit-deleteProduct",this.tempProduct),this.tempProduct={}}}},We={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static","data-bs-keyboard":"false"},Ke={class:"modal-dialog"},Ye={class:"modal-content"},ze={class:"modal-header"},Je=t("h5",{class:"modal-title fs-md-4 fs-6 fw-bold text-danger"},"Delete Product",-1),je={class:"modal-body d-flex flex-column"},Ge=t("h2",{class:"fs-md-5 fs-6 mb-3"},"是否要刪除此商品？",-1),Qe=t("h3",{class:"fs-6"},"商品資訊：",-1),Xe=["src"],He={class:"modal-footer"};function Ze(i,e,a,o,s,c){return P(),w("div",We,[t("div",Ke,[t("div",Ye,[t("div",ze,[Je,t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...d)=>i.hideModal&&i.hideModal(...d))},"X")]),t("div",je,[Ge,Qe,t("p",null,"ID："+V(s.tempProduct.id),1),t("p",null,"Title："+V(s.tempProduct.title),1),t("p",null,"Category："+V(s.tempProduct.category),1),t("img",{src:s.tempProduct.imageUrl,alt:"商品圖片",class:"w-50 align-self-center object-fit-cover"},null,8,Xe)]),t("div",He,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=(...d)=>i.hideModal&&i.hideModal(...d))},"Close"),t("button",{type:"button",class:"btn btn-danger text-primary",onClick:e[2]||(e[2]=(...d)=>c.sendProduct&&c.sendProduct(...d))},"Delete Product")])])])],512)}const ts=Y(Re,[["render",Ze]]);var gt={exports:{}};/*!
  * Bootstrap toast.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(i,e){(function(a,o){i.exports=o(mt(),W(),pt(),K())})(B,function(a,o,s,c){const d="toast",m=".bs.toast",g=`mouseover${m}`,p=`mouseout${m}`,h=`focusin${m}`,n=`focusout${m}`,l=`hide${m}`,y=`hidden${m}`,k=`show${m}`,x=`shown${m}`,b="fade",M="hide",A="show",L="showing",I={animation:"boolean",autohide:"boolean",delay:"number"},U={animation:!0,autohide:!0,delay:5e3};class r extends a{constructor(f,T){super(f,T),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return U}static get DefaultType(){return I}static get NAME(){return d}show(){if(o.trigger(this._element,k).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(b);const T=()=>{this._element.classList.remove(L),o.trigger(this._element,x),this._maybeScheduleHide()};this._element.classList.remove(M),c.reflow(this._element),this._element.classList.add(A,L),this._queueCallback(T,this._element,this._config.animation)}hide(){if(!this.isShown()||o.trigger(this._element,l).defaultPrevented)return;const T=()=>{this._element.classList.add(M),this._element.classList.remove(L,A),o.trigger(this._element,y)};this._element.classList.add(L),this._queueCallback(T,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(A),super.dispose()}isShown(){return this._element.classList.contains(A)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(f,T){switch(f.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=T;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=T;break}}if(T){this._clearTimeout();return}const F=f.relatedTarget;this._element===F||this._element.contains(F)||this._maybeScheduleHide()}_setListeners(){o.on(this._element,g,f=>this._onInteraction(f,!0)),o.on(this._element,p,f=>this._onInteraction(f,!1)),o.on(this._element,h,f=>this._onInteraction(f,!0)),o.on(this._element,n,f=>this._onInteraction(f,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(f){return this.each(function(){const T=r.getOrCreateInstance(this,f);if(typeof f=="string"){if(typeof T[f]>"u")throw new TypeError(`No method named "${f}"`);T[f](this)}})}}return s.enableDismissTrigger(r),c.defineJQueryPlugin(r),r})})(gt);var es=gt.exports;const ss=ht(es),is={name:"Toast",props:["msg"],data(){return{toast:{}}},methods:{closeToast(){this.toast._element.remove()}},mounted(){const i=this.$refs.toast;this.toast=new ss(i,{animation:!0,autohide:!1,delay:1e3}),this.toast.show(),setTimeout(()=>{this.toast._element.remove()},1400)}},os={class:"toast bg-dark",role:"alert","aria-live":"assertive","aria-atomic":"true",ref:"toast"},ns={class:"toast-header"},as={class:"me-auto"},ls=t("strong",{class:"me-auto"},"Bootstrap",-1),rs={key:0,class:"toast-body"};function cs(i,e,a,o,s,c){return P(),w("div",os,[t("div",ns,[t("span",{class:N([`bg-${a.msg.style}`,"p-2 d-inline-block"])},null,2),t("strong",as,V(a.msg.title),1),ls,t("button",{type:"button",class:"btn btn-close p-0","data-bs-dismiss":"toast","aria-label":"Close",onClick:e[0]||(e[0]=(...d)=>c.closeToast&&c.closeToast(...d))},"X")]),a.msg.content?(P(),w("div",rs,V(a.msg.content),1)):R("",!0)],512)}const ds=Y(is,[["render",cs]]),us={data(){return{messages:[]}},components:{Toast:ds},inject:["emitter"],mounted(){this.emitter.on("push-message",i=>{const{style:e="success",title:a,content:o}=i;this.messages.push({style:e,title:a,content:o}),setTimeout(()=>{this.messages.shift()},1400)})}},ms={class:"toast-container position-absolute pe-3 top-0 end-0"};function hs(i,e,a,o,s,c){const d=O("Toast");return P(),w("div",ms,[(P(!0),w(G,null,nt(s.messages,(u,m)=>(P(),xt(d,{key:m,msg:u},null,8,["msg"]))),128))])}const _s=Y(us,[["render",hs]]),J="https://ec-course-api.hexschool.io/",j="bftsai",ps={data(){return{products:[],pagination:{},tempProduct:{},isLoading:!1}},inject:["emitter"],components:{ProductModal:qe,DeleteModal:ts,ToastList:_s,Loading:Bt},methods:{async checkLogin(){try{this.isLoading=!0;const i=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common.Authorization=i;const e=(await this.axios.post("https://ec-course-api.hexschool.io//v2/api/user/check")).data;this.isLoading=!1,e.success?this.getProducts(1):this.$router.push({name:"member"})}catch(i){this.isLoading=!1,console.log(i),this.$router.push({name:"member"})}},async getProducts(i){try{this.isLoading=!0;const e=(await this.axios.get(`${J}v2/api/${j}/admin/products?page=${i}`)).data;e.success?(C.fire({title:"已取得產品列表!",icon:"success",showConfirmButton:!1,timer:1500}),this.products=e.products,this.pagination=e.pagination):C.fire({title:"Error!",icon:"error",showConfirmButton:!1,timer:1500}),this.isLoading=!1,console.log(this.products,this.pagination)}catch(e){console.log(e.response),this.isLoading=!1,C.fire({title:"Error!",icon:"error",showConfirmButton:!1,timer:1500}),this.$router.push({name:"member"})}},async postProduct(i){try{this.$refs.productModal.hideModal(),this.isLoading=!0;const e=(await this.axios.post(`${J}v2/api/${j}/admin/product`,{data:i})).data;this.isLoading=!1,e.success?(C.fire({title:e.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):C.fire({title:e.message,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}catch(e){this.isLoading=!1,console.log(e.response),C.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}},async pathProduct(i){try{this.$refs.productModal.hideModal(),this.isLoading=!0;const e=i.id,a=(await this.axios.put(`${J}v2/api/${j}/admin/product/${e}`,{data:i})).data;this.isLoading=!1,a.success?(C.fire({title:a.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):C.fire({title:a.message,icon:"error",showConfirmButton:!1,timer:1500}),console.log(a),this.tempProduct={}}catch(e){this.isLoading=!1,console.log(e.response),C.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}},async deleteProduct(i){try{this.$refs.deleteModal.hideModal(),this.isLoading=!0;const e=(await this.axios.delete(`${J}v2/api/${j}/admin/product/${i.id}`)).data;this.isLoading=!1,e.success?(C.fire({title:e.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):C.fire({title:e.message,icon:"error",showConfirmButton:!1,timer:1500})}catch(e){this.isLoading=!1,console.log(e.response),C.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500})}},openAddProductModal(){this.tempProduct={imageUrl:"",imagesUrl:[]},this.$refs.productModal.showModal()},openEditProductModal(i){this.tempProduct=i,this.$refs.productModal.showModal()},deleteProductModal(i){this.tempProduct=i,this.$refs.deleteModal.showModal()},hideModal(){this.tempProduct={}},successToast(){this.emitter.emit("push-message",{style:"success",title:"更新成功"})},errorToast(){this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:"更新失敗內容"})}},mounted(){this.checkLogin()}},fs=t("h1",null,"Products List",-1),gs={class:"text-end"},bs={class:"table-dark table table-hover mt-4"},Es=t("thead",null,[t("tr",{class:"line-height-60"},[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{class:"text-center",width:"120"},"原價"),t("th",{class:"text-center",width:"120"},"售價"),t("th",{class:"text-center",width:"100"},"是否啟用"),t("th",{class:"text-center",width:"210"},"編輯")])],-1),ys={class:"text-end"},vs={class:"text-end"},Ps={class:"text-center"},ws={key:0,class:"text-success"},As={key:1,class:"text-secondary"},Ts=["onClick"],ks=["onClick"];function xs(i,e,a,o,s,c){const d=O("Loading"),u=O("ToastList"),m=O("ProductModal"),g=O("DeleteModal");return P(),w(G,null,[E(d,{"prop-boolean":s.isLoading},null,8,["prop-boolean"]),E(u),fs,t("div",gs,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...p)=>c.openAddProductModal&&c.openAddProductModal(...p))},"增加產品")]),t("table",bs,[Es,t("tbody",null,[(P(!0),w(G,null,nt(s.products,p=>(P(),w("tr",{class:"line-height-60",key:p.id},[t("td",null,V(p.category),1),t("td",null,V(p.title),1),t("td",ys,V(p.origin_price),1),t("td",vs,V(p.price),1),t("td",Ps,[p.is_enabled?(P(),w("span",ws,"啟用")):(P(),w("span",As,"未啟用"))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:h=>c.openEditProductModal(p)},"編輯",8,Ts),t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:h=>c.deleteProductModal(p)},"刪除",8,ks)])]))),128))])]),E(m,{ref:"productModal",product:s.tempProduct,"edit-product":s.tempProduct,onEmitPostProduct:c.postProduct,onEmitPathProduct:c.pathProduct,onEmitHideModal:c.hideModal},null,8,["product","edit-product","onEmitPostProduct","onEmitPathProduct","onEmitHideModal"]),E(g,{ref:"deleteModal",product:s.tempProduct,onEmitHideModal:c.hideModal,onEmitDeleteProduct:c.deleteProduct},null,8,["product","onEmitHideModal","onEmitDeleteProduct"])],64)}const Ds=Y(ps,[["render",xs]]);export{Ds as default};
