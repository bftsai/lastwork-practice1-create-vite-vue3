import{f as W,g as ut,h as K,i as B,j as Q,k as Tt,l as mt,m as ht,_ as j,o as p,c as f,a as P,w as et,b as t,n as V,d as O,p as w,F as R,q as X,s as st,v as at,t as xt,r as L,u as S,x as _t,y as Y}from"./index-PhRdil2F.js";import{d as H,s as Ct,c as Mt,l as St,z as Nt,F as Ot,a as Dt,E as Lt,r as Vt,e as It,i as Ut,b as $t}from"./zh_TW-yU0QW9dv.js";import{L as Bt}from"./Loading-cR_otsKF.js";var pt={exports:{}},it={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var lt;function jt(){return lt||(lt=1,function(o,e){(function(i,n){o.exports=n(W(),ut(),K())})(B,function(i,n,s){const l="backdrop",r="fade",m="show",h=`mousedown.bs.${l}`,b={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},k={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class c extends n{constructor(d){super(),this._config=this._getConfig(d),this._isAppended=!1,this._element=null}static get Default(){return b}static get DefaultType(){return k}static get NAME(){return l}show(d){if(!this._config.isVisible){s.execute(d);return}this._append();const y=this._getElement();this._config.isAnimated&&s.reflow(y),y.classList.add(m),this._emulateAnimation(()=>{s.execute(d)})}hide(d){if(!this._config.isVisible){s.execute(d);return}this._getElement().classList.remove(m),this._emulateAnimation(()=>{this.dispose(),s.execute(d)})}dispose(){this._isAppended&&(i.off(this._element,h),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const d=document.createElement("div");d.className=this._config.className,this._config.isAnimated&&d.classList.add(r),this._element=d}return this._element}_configAfterMerge(d){return d.rootElement=s.getElement(d.rootElement),d}_append(){if(this._isAppended)return;const d=this._getElement();this._config.rootElement.append(d),i.on(d,h,()=>{s.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(d){s.executeAfterTransition(d,this._getElement(),this._config.isAnimated)}}return c})}(it)),it.exports}var z={exports:{}};/*!
  * Bootstrap component-functions.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var rt;function gt(){return rt||(rt=1,function(o,e){(function(i,n){n(e,W(),Q(),K())})(B,function(i,n,s,l){const r=(m,h="hide")=>{const b=`click.dismiss${m.EVENT_KEY}`,k=m.NAME;n.on(document,b,`[data-bs-dismiss="${k}"]`,function(c){if(["A","AREA"].includes(this.tagName)&&c.preventDefault(),l.isDisabled(this))return;const a=s.getElementFromSelector(this)||this.closest(`.${k}`);m.getOrCreateInstance(a)[h]()})};i.enableDismissTrigger=r,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})})}(z,z.exports)),z.exports}var ot={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var ct;function Ft(){return ct||(ct=1,function(o,e){(function(i,n){o.exports=n(W(),Q(),ut())})(B,function(i,n,s){const l="focustrap",m=".bs.focustrap",h=`focusin${m}`,b=`keydown.tab${m}`,k="Tab",c="forward",a="backward",d={autofocus:!0,trapElement:null},y={autofocus:"boolean",trapElement:"element"};class x extends s{constructor(E){super(),this._config=this._getConfig(E),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return d}static get DefaultType(){return y}static get NAME(){return l}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),i.off(document,m),i.on(document,h,E=>this._handleFocusin(E)),i.on(document,b,E=>this._handleKeydown(E)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,i.off(document,m))}_handleFocusin(E){const{trapElement:M}=this._config;if(E.target===document||E.target===M||M.contains(E.target))return;const A=n.focusableChildren(M);A.length===0?M.focus():this._lastTabNavDirection===a?A[A.length-1].focus():A[0].focus()}_handleKeydown(E){E.key===k&&(this._lastTabNavDirection=E.shiftKey?a:c)}}return x})}(ot)),ot.exports}var nt={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var dt;function qt(){return dt||(dt=1,function(o,e){(function(i,n){o.exports=n(Tt(),Q(),K())})(B,function(i,n,s){const l=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",r=".sticky-top",m="padding-right",h="margin-right";class b{constructor(){this._element=document.body}getWidth(){const c=document.documentElement.clientWidth;return Math.abs(window.innerWidth-c)}hide(){const c=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,m,a=>a+c),this._setElementAttributes(l,m,a=>a+c),this._setElementAttributes(r,h,a=>a-c)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,m),this._resetElementAttributes(l,m),this._resetElementAttributes(r,h)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(c,a,d){const y=this.getWidth(),x=C=>{if(C!==this._element&&window.innerWidth>C.clientWidth+y)return;this._saveInitialAttribute(C,a);const E=window.getComputedStyle(C).getPropertyValue(a);C.style.setProperty(a,`${d(Number.parseFloat(E))}px`)};this._applyManipulationCallback(c,x)}_saveInitialAttribute(c,a){const d=c.style.getPropertyValue(a);d&&i.setDataAttribute(c,a,d)}_resetElementAttributes(c,a){const d=y=>{const x=i.getDataAttribute(y,a);if(x===null){y.style.removeProperty(a);return}i.removeDataAttribute(y,a),y.style.setProperty(a,x)};this._applyManipulationCallback(c,d)}_applyManipulationCallback(c,a){if(s.isElement(c)){a(c);return}for(const d of n.find(c,this._element))a(d)}}return b})}(nt)),nt.exports}/*!
  * Bootstrap modal.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(o,e){(function(i,n){o.exports=n(mt(),W(),Q(),jt(),gt(),Ft(),K(),qt())})(B,function(i,n,s,l,r,m,h,b){const k="modal",a=".bs.modal",d=".data-api",y="Escape",x=`hide${a}`,C=`hidePrevented${a}`,E=`hidden${a}`,M=`show${a}`,A=`shown${a}`,D=`resize${a}`,U=`click.dismiss${a}`,$=`mousedown.dismiss${a}`,u=`keydown.dismiss${a}`,Z=`click${a}${d}`,g="modal-open",T="fade",F="show",tt="modal-static",Et=".modal.show",Pt=".modal-dialog",yt=".modal-body",vt='[data-bs-toggle="modal"]',wt={backdrop:!0,focus:!0,keyboard:!0},kt={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class I extends i{constructor(_,v){super(_,v),this._dialog=s.findOne(Pt,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new b,this._addEventListeners()}static get Default(){return wt}static get DefaultType(){return kt}static get NAME(){return k}toggle(_){return this._isShown?this.hide():this.show(_)}show(_){this._isShown||this._isTransitioning||n.trigger(this._element,M,{relatedTarget:_}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(g),this._adjustDialog(),this._backdrop.show(()=>this._showElement(_)))}hide(){!this._isShown||this._isTransitioning||n.trigger(this._element,x).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(F),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){n.off(window,a),n.off(this._dialog,a),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new l({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new m({trapElement:this._element})}_showElement(_){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const v=s.findOne(yt,this._dialog);v&&(v.scrollTop=0),h.reflow(this._element),this._element.classList.add(F);const N=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,n.trigger(this._element,A,{relatedTarget:_})};this._queueCallback(N,this._dialog,this._isAnimated())}_addEventListeners(){n.on(this._element,u,_=>{if(_.key===y){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),n.on(window,D,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),n.on(this._element,$,_=>{n.one(this._element,U,v=>{if(!(this._element!==_.target||this._element!==v.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(g),this._resetAdjustments(),this._scrollBar.reset(),n.trigger(this._element,E)})}_isAnimated(){return this._element.classList.contains(T)}_triggerBackdropTransition(){if(n.trigger(this._element,C).defaultPrevented)return;const v=this._element.scrollHeight>document.documentElement.clientHeight,N=this._element.style.overflowY;N==="hidden"||this._element.classList.contains(tt)||(v||(this._element.style.overflowY="hidden"),this._element.classList.add(tt),this._queueCallback(()=>{this._element.classList.remove(tt),this._queueCallback(()=>{this._element.style.overflowY=N},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const _=this._element.scrollHeight>document.documentElement.clientHeight,v=this._scrollBar.getWidth(),N=v>0;if(N&&!_){const q=h.isRTL()?"paddingLeft":"paddingRight";this._element.style[q]=`${v}px`}if(!N&&_){const q=h.isRTL()?"paddingRight":"paddingLeft";this._element.style[q]=`${v}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(_,v){return this.each(function(){const N=I.getOrCreateInstance(this,_);if(typeof _=="string"){if(typeof N[_]>"u")throw new TypeError(`No method named "${_}"`);N[_](v)}})}}return n.on(document,Z,vt,function(At){const _=s.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&At.preventDefault(),n.one(_,M,q=>{q.defaultPrevented||n.one(_,E,()=>{h.isVisible(this)&&this.focus()})});const v=s.findOne(Et);v&&I.getInstance(v).hide(),I.getOrCreateInstance(_).toggle(this)}),r.enableDismissTrigger(I),h.defineJQueryPlugin(I),I})})(pt);var Rt=pt.exports;const Wt=ht(Rt),ft={methods:{showModal(){const o=new Wt(this.$refs.modal,{keyboard:!1});this.modal=o,this.modal.show()},hideModal(){this.tempProduct={},this.$emit("emit-hideModal"),this.modal.hide()}}},Kt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20style='margin:%20auto;%20background-image:%20none;%20display:%20block;%20shape-rendering:%20auto;'%20width='50px'%20height='50px'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%3e%3ccircle%20cx='50'%20cy='50'%20r='32'%20stroke-width='8'%20stroke='%23fe718d'%20stroke-dasharray='50.26548245743669%2050.26548245743669'%20fill='none'%20stroke-linecap='round'%3e%3canimateTransform%20attributeName='transform'%20type='rotate'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='0%2050%2050;360%2050%2050'%3e%3c/animateTransform%3e%3c/circle%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io/%20--%3e%3c/svg%3e",Yt="https://ec-course-api.hexschool.io/",zt="bftsai";H("required",Vt);H("email",It);H("integer",Ut);H("regex",$t);Ct("zh_TW");Mt({generateMessage:St({zh_TW:Nt}),validateOnInput:!0});const Jt={data(){return{modal:{},tempProduct:{},imageUrl:"",loading:!1}},props:{product:{type:Object,default(){return{}}},editProduct:{type:Object,default(){return{}}}},components:{VForm:Ot,VField:Dt,ErrorMessage:Lt},mixins:[ft],watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product)),this.imageUrl="";const o=document.querySelector("#imageUpload");o.value=""},editProduct(){this.tempProduct=JSON.parse(JSON.stringify(this.editProduct))}},methods:{isImage(){var o;return this.tempProduct.imageUrl&&((o=this.tempProduct)==null?void 0:o.imagesUrl.length)>=1?!0:"請至少新增兩張產品圖片"},async getImageUrl(o){try{this.loading=!0;const e=o.target.files[0],i=new FormData;i.append("file-to-upload",e);const n=(await this.axios.post(`${Yt}v2/api/${zt}/admin/upload`,i)).data;n.success&&(this.imageUrl=n.imageUrl),this.loading=!1}catch(e){console.log(e.response),this.loading=!1}},addImage(){this.tempProduct.imageUrl?this.tempProduct.imagesUrl.push(this.imageUrl):this.tempProduct.imageUrl=this.imageUrl,this.imageUrl=""},sendProduct(){var o;try{(o=this.tempProduct)!=null&&o.id?(this.tempProduct.is_enabled!==!0&&!this.tempProduct.is_enabled?this.tempProduct.is_enabled=0:this.tempProduct.is_enabled===!0&&(this.tempProduct.is_enabled=1),console.log("path",this.tempProduct),this.$emit("emit-path-product",this.tempProduct)):(this.tempProduct.is_enabled===!0?this.tempProduct.is_enabled=1:this.tempProduct.is_enabled=0,console.log("new",this.tempProduct),this.$emit("emit-post-product",this.tempProduct)),this.tempProduct={}}catch(e){console.log(e)}}},mounted(){}},Gt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static","data-bs-keyboard":"false"},Qt={class:"modal-content border-0"},Xt={class:"modal-header"},Ht=t("h5",{class:"modal-title fs-md-4 fs-6 fw-bold"},"新增產品",-1),Zt={class:"modal-body"},te={class:"row"},ee={class:"col-sm-4"},se={key:0,class:"mb-3"},ie=["src"],oe={class:"mb-3"},ne={for:"imageInput",class:"d-flex flex-column"},ae={class:"mb-3"},le={for:"imageUpload",class:"d-flex flex-column"},re={class:"d-flex align-items-center"},ce=["disabled"],de={key:0,src:Kt,alt:"loading"},ue={key:1,class:"mb-3"},me=["src"],he=["src"],_e={class:"col-sm-8"},pe={class:"mb-3"},ge={for:"title",class:"d-flex flex-column"},fe={class:"row"},be={class:"col-sm-6"},Ee={class:"mb-3"},Pe={for:"category",class:"d-flex flex-column"},ye={class:"col-sm-6"},ve={class:"mb-3"},we={for:"unit",class:"d-flex flex-column"},ke={class:"row"},Ae={class:"col-sm-6"},Te={class:"mb-3"},xe={for:"origin_price",class:"d-flex flex-column"},Ce={class:"col-sm-6"},Me={class:"mb-3"},Se={for:"price",class:"d-flex flex-column"},Ne={class:"mb-3"},Oe={for:"description",class:"d-flex flex-column"},De={class:"mb-3"},Le={for:"content",class:"d-flex flex-column"},Ve={class:"mb-3"},Ie={for:"is_enabled",class:"d-flex align-items-center"},Ue=["checked"],$e={class:"modal-footer"},Be=t("button",{type:"submit",class:"btn btn-primary"},"Save changes",-1);function je(o,e,i,n,s,l){const r=L("v-field"),m=L("error-message"),h=L("v-form");return p(),f("div",Gt,[P(h,{class:"modal-dialog modal-xl",onSubmit:l.sendProduct,novalidate:""},{default:et(({errors:b})=>{var k,c,a,d,y,x,C,E,M,A,D,U,$;return[t("div",Qt,[t("div",Xt,[Ht,t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...u)=>o.hideModal&&o.hideModal(...u))},"X")]),t("div",Zt,[t("div",te,[t("div",ee,[s.imageUrl?(p(),f("div",se,[t("img",{src:s.imageUrl,alt:"主圖照片",class:"object-fit-cover w-100"},null,8,ie)])):V("",!0),t("div",oe,[t("label",ne,[O(" 輸入圖片網址 "),P(r,{name:"image",class:w({"is-invalid":b.image}),id:"imageInput",type:"text",placeholder:"請輸入圖片連結",modelValue:s.imageUrl,"onUpdate:modelValue":e[1]||(e[1]=u=>s.imageUrl=u),disabled:((c=(k=s.tempProduct)==null?void 0:k.imagesUrl)==null?void 0:c.length)>=5,rules:l.isImage},null,8,["class","modelValue","disabled","rules"]),P(m,{name:"image",class:"invalid-feedback"}),t("span",{class:w(["text-danger",{"d-none":((d=(a=s.tempProduct)==null?void 0:a.imagesUrl)==null?void 0:d.length)!==5}])},"上傳照片數量已滿",2)])]),t("div",ae,[t("label",le,[O(" 或 上傳圖片 "),t("div",re,[t("input",{id:"imageUpload",type:"file",disabled:((x=(y=s.tempProduct)==null?void 0:y.imagesUrl)==null?void 0:x.length)>=5,onChange:e[2]||(e[2]=(...u)=>l.getImageUrl&&l.getImageUrl(...u))},null,40,ce),s.loading?(p(),f("img",de)):V("",!0)]),t("span",{class:w(["text-danger",{"d-none":((E=(C=s.tempProduct)==null?void 0:C.imagesUrl)==null?void 0:E.length)!==5}])},"上傳照片數量已滿",2)])]),s.tempProduct.imageUrl?(p(),f("div",ue,[(M=s.tempProduct)!=null&&M.imageUrl?(p(),f("img",{key:0,class:"w-45 me-3 mb-3",src:(A=s.tempProduct)==null?void 0:A.imageUrl,alt:""},null,8,me)):V("",!0),(p(!0),f(R,null,X(s.tempProduct.imagesUrl,(u,Z)=>(p(),f("img",{src:u,alt:"附圖 key",key:"key"+Z,class:"w-45 me-3"},null,8,he))),128))])):V("",!0),t("button",{type:"button",class:w(["btn btn-outline-primary w-100",{disabled:((U=(D=s.tempProduct)==null?void 0:D.imagesUrl)==null?void 0:U.length)===5}]),onClick:e[3]||(e[3]=(...u)=>l.addImage&&l.addImage(...u))},"新增圖片",2)]),t("div",_e,[t("div",pe,[t("label",ge,[O(" 標題 "),P(r,{name:"標題",class:w({"is-invalid":b.標題}),id:"title",type:"text",placeholder:"請輸入標題",modelValue:s.tempProduct.title,"onUpdate:modelValue":e[4]||(e[4]=u=>s.tempProduct.title=u),rules:"required"},null,8,["class","modelValue"]),P(m,{name:"標題",class:"invalid-feedback"})])]),t("div",fe,[t("div",be,[t("div",Ee,[t("label",Pe,[O(" 分類 "),P(r,{name:"分類",class:w({"is-invalid":b.分類}),id:"category",type:"text",placeholder:"請輸入分類",modelValue:s.tempProduct.category,"onUpdate:modelValue":e[5]||(e[5]=u=>s.tempProduct.category=u),rules:"required"},null,8,["class","modelValue"]),P(m,{name:"分類",class:"invalid-feedback"})])])]),t("div",ye,[t("div",ve,[t("label",we,[O(" 單位 "),P(r,{name:"單位",class:w({"is-invalid":b.單位}),id:"unit",type:"text",placeholder:"請輸入單位",modelValue:s.tempProduct.unit,"onUpdate:modelValue":e[6]||(e[6]=u=>s.tempProduct.unit=u),rules:"required"},null,8,["class","modelValue"]),P(m,{name:"單位",class:"invalid-feedback"})])])])]),t("div",ke,[t("div",Ae,[t("div",Te,[t("label",xe,[O(" 原價 "),P(r,{name:"原價",class:w({"is-invalid":b.原價}),id:"origin_price",type:"number",placeholder:"請輸入原價",modelValue:s.tempProduct.origin_price,"onUpdate:modelValue":e[7]||(e[7]=u=>s.tempProduct.origin_price=u),rules:"required|integer"},null,8,["class","modelValue"]),P(m,{name:"原價",class:"invalid-feedback"})])])]),t("div",Ce,[t("div",Me,[t("label",Se,[O(" 售價 "),P(r,{name:"售價",class:w({"is-invalid":b.售價}),id:"price",type:"number",placeholder:"請輸入售價",modelValue:s.tempProduct.price,"onUpdate:modelValue":e[8]||(e[8]=u=>s.tempProduct.price=u),rules:"required|integer"},null,8,["class","modelValue"]),P(m,{name:"售價",class:"invalid-feedback"})])])])]),t("div",Ne,[t("label",Oe,[O(" 產品描述 "),P(r,{name:"產品描述",rules:"required",modelValue:s.tempProduct.description,"onUpdate:modelValue":e[10]||(e[10]=u=>s.tempProduct.description=u)},{default:et(()=>[st(t("textarea",{name:"產品描述",class:w({"is-invalid":b.產品描述}),id:"description",cols:"30",rows:"3",placeholder:"請輸入產品描述","onUpdate:modelValue":e[9]||(e[9]=u=>s.tempProduct.description=u)},null,2),[[at,s.tempProduct.description]]),P(m,{name:"產品描述",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",De,[t("label",Le,[O(" 說明內容 "),P(r,{name:"說明內容",rules:"required",modelValue:s.tempProduct.content,"onUpdate:modelValue":e[12]||(e[12]=u=>s.tempProduct.content=u)},{default:et(()=>[st(t("textarea",{name:"content",class:w({"is-invalid":b.說明內容}),id:"content",cols:"30",rows:"3",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[11]||(e[11]=u=>s.tempProduct.content=u)},null,2),[[at,s.tempProduct.content]]),P(m,{name:"說明內容",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",Ve,[t("label",Ie,[st(t("input",{type:"checkbox",name:"is_enabled",id:"is_enabled",class:"me-2",checked:($=s.tempProduct)==null?void 0:$.is_enabled,"onUpdate:modelValue":e[13]||(e[13]=u=>s.tempProduct.is_enabled=u)},null,8,Ue),[[xt,s.tempProduct.is_enabled]]),O(" 是否啟用 ")])])])])]),t("div",$e,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[14]||(e[14]=(...u)=>o.hideModal&&o.hideModal(...u))},"Close"),Be])])]}),_:1},8,["onSubmit"])],512)}const Fe=j(Jt,[["render",je]]),qe={data(){return{tempProduct:{}}},mixins:[ft],props:{product:{type:Object,default(){return{}}}},watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},methods:{sendProduct(){this.$emit("emit-deleteProduct",this.tempProduct),this.tempProduct={}}}},Re={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static","data-bs-keyboard":"false"},We={class:"modal-dialog"},Ke={class:"modal-content"},Ye={class:"modal-header"},ze=t("h5",{class:"modal-title fs-md-4 fs-6 fw-bold text-danger"},"Delete Product",-1),Je={class:"modal-body d-flex flex-column"},Ge=t("h2",{class:"fs-md-5 fs-6 mb-3"},"是否要刪除此商品？",-1),Qe=t("h3",{class:"fs-6"},"商品資訊：",-1),Xe=["src"],He={class:"modal-footer"};function Ze(o,e,i,n,s,l){return p(),f("div",Re,[t("div",We,[t("div",Ke,[t("div",Ye,[ze,t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...r)=>o.hideModal&&o.hideModal(...r))},"X")]),t("div",Je,[Ge,Qe,t("p",null,"ID："+S(s.tempProduct.id),1),t("p",null,"Title："+S(s.tempProduct.title),1),t("p",null,"Category："+S(s.tempProduct.category),1),t("img",{src:s.tempProduct.imageUrl,alt:"商品圖片",class:"w-50 align-self-center object-fit-cover"},null,8,Xe)]),t("div",He,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=(...r)=>o.hideModal&&o.hideModal(...r))},"Close"),t("button",{type:"button",class:"btn btn-danger text-primary",onClick:e[2]||(e[2]=(...r)=>l.sendProduct&&l.sendProduct(...r))},"Delete Product")])])])],512)}const ts=j(qe,[["render",Ze]]);var bt={exports:{}};/*!
  * Bootstrap toast.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(o,e){(function(i,n){o.exports=n(mt(),W(),gt(),K())})(B,function(i,n,s,l){const r="toast",h=".bs.toast",b=`mouseover${h}`,k=`mouseout${h}`,c=`focusin${h}`,a=`focusout${h}`,d=`hide${h}`,y=`hidden${h}`,x=`show${h}`,C=`shown${h}`,E="fade",M="hide",A="show",D="showing",U={animation:"boolean",autohide:"boolean",delay:"number"},$={animation:!0,autohide:!0,delay:5e3};class u extends i{constructor(g,T){super(g,T),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return $}static get DefaultType(){return U}static get NAME(){return r}show(){if(n.trigger(this._element,x).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(E);const T=()=>{this._element.classList.remove(D),n.trigger(this._element,C),this._maybeScheduleHide()};this._element.classList.remove(M),l.reflow(this._element),this._element.classList.add(A,D),this._queueCallback(T,this._element,this._config.animation)}hide(){if(!this.isShown()||n.trigger(this._element,d).defaultPrevented)return;const T=()=>{this._element.classList.add(M),this._element.classList.remove(D,A),n.trigger(this._element,y)};this._element.classList.add(D),this._queueCallback(T,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(A),super.dispose()}isShown(){return this._element.classList.contains(A)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(g,T){switch(g.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=T;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=T;break}}if(T){this._clearTimeout();return}const F=g.relatedTarget;this._element===F||this._element.contains(F)||this._maybeScheduleHide()}_setListeners(){n.on(this._element,b,g=>this._onInteraction(g,!0)),n.on(this._element,k,g=>this._onInteraction(g,!1)),n.on(this._element,c,g=>this._onInteraction(g,!0)),n.on(this._element,a,g=>this._onInteraction(g,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(g){return this.each(function(){const T=u.getOrCreateInstance(this,g);if(typeof g=="string"){if(typeof T[g]>"u")throw new TypeError(`No method named "${g}"`);T[g](this)}})}}return s.enableDismissTrigger(u),l.defineJQueryPlugin(u),u})})(bt);var es=bt.exports;const ss=ht(es),is={name:"Toast",props:["msg"],data(){return{toast:{}}},methods:{closeToast(){this.toast._element.remove()}},mounted(){const o=this.$refs.toast;this.toast=new ss(o,{animation:!0,autohide:!1,delay:3e3}),this.toast.show(),setTimeout(()=>{this.toast._element.remove()},3400)}},os={class:"toast bg-dark",role:"alert","aria-live":"assertive","aria-atomic":"true",ref:"toast"},ns={class:"toast-header"},as={class:"me-auto"},ls=t("strong",{class:"me-auto"},"Bootstrap",-1),rs={key:0,class:"toast-body"};function cs(o,e,i,n,s,l){return p(),f("div",os,[t("div",ns,[t("span",{class:w([`bg-${i.msg.style}`,"p-2 d-inline-block"])},null,2),t("strong",as,S(i.msg.title),1),ls,t("button",{type:"button",class:"btn btn-close p-0","data-bs-dismiss":"toast","aria-label":"Close",onClick:e[0]||(e[0]=(...r)=>l.closeToast&&l.closeToast(...r))},"X")]),i.msg.content?(p(),f("div",rs,S(i.msg.content),1)):V("",!0)],512)}const ds=j(is,[["render",cs]]),us={data(){return{messages:[]}},components:{Toast:ds},inject:["emitter"],mounted(){this.emitter.on("push-message",o=>{const{style:e="success",title:i,content:n}=o;this.messages.push({style:e,title:i,content:n}),setTimeout(()=>{this.messages.shift()},3400)})}},ms={class:"toast-container position-absolute pe-3 top-0 end-0 z-max"};function hs(o,e,i,n,s,l){const r=L("Toast");return p(),f("div",ms,[(p(!0),f(R,null,X(s.messages,(m,h)=>(p(),_t(r,{key:h,msg:m},null,8,["msg"]))),128))])}const _s=j(us,[["render",hs]]),ps={data(){return{}},props:["propPaginationObj"],watch:{propPaginationObj(){console.log(this.propPaginationObj)}},methods:{changePage(o){o!==this.propPaginationObj.current_page&&this.$emit("emit-page",o)}},mounted(){}},gs={"aria-label":"...",class:"py-3"},fs={class:"pagination pagination-lg justify-content-center"},bs={class:"page-item"},Es={class:"page-item"},Ps={key:0,class:"page-link disabled"},ys=["onClick"],vs={class:"page-item"},ws={key:0,class:"page-link disabled"},ks={class:"page-item"};function As(o,e,i,n,s,l){return p(),f("nav",gs,[t("ul",fs,[t("li",{class:w(["page-item",{disabled:!i.propPaginationObj.has_pre}])},[t("a",{class:"page-link",onClick:e[0]||(e[0]=r=>l.changePage(i.propPaginationObj.current_page-1))},"Previous")],2),t("li",bs,[t("a",{class:w(["page-link",{active:i.propPaginationObj.current_page===1,"text-dark":i.propPaginationObj.current_page===1}]),href:"#",onClick:e[1]||(e[1]=Y(r=>l.changePage(1),["prevent"]))},S(1),2)]),t("li",Es,[i.propPaginationObj.current_page>3?(p(),f("span",Ps,"...")):V("",!0)]),(p(!0),f(R,null,X(i.propPaginationObj.total_pages,(r,m)=>(p(),f("li",{class:"page-item",key:"item"+m},[r!==1&&r!==i.propPaginationObj.total_pages&&r>i.propPaginationObj.current_page-2&&r<i.propPaginationObj.current_page+2?(p(),f("a",{key:0,class:w(["page-link",{active:i.propPaginationObj.current_page===r,"text-dark":i.propPaginationObj.current_page===r}]),href:"#",onClick:Y(h=>l.changePage(r),["prevent"])},S(r),11,ys)):V("",!0)]))),128)),t("li",vs,[i.propPaginationObj.current_page<i.propPaginationObj.total_pages-2?(p(),f("span",ws,"...")):V("",!0)]),t("li",ks,[t("a",{class:w(["page-link",{active:i.propPaginationObj.current_page===i.propPaginationObj.total_pages,"text-dark":i.propPaginationObj.current_page===i.propPaginationObj.total_pages}]),href:"#",onClick:e[2]||(e[2]=Y(r=>l.changePage(i.propPaginationObj.total_pages),["prevent"]))},S(i.propPaginationObj.total_pages),3)]),t("li",{class:w(["page-item",{disabled:!i.propPaginationObj.has_next}])},[t("a",{class:"page-link",href:"#",onClick:e[3]||(e[3]=Y(r=>l.changePage(i.propPaginationObj.current_page+1),["prevent"]))},"Next")],2)])])}const Ts=j(ps,[["render",As]]),J="https://ec-course-api.hexschool.io/",G="bftsai",xs={data(){return{products:[],pagination:{},tempProduct:{},isLoading:!1}},inject:["emitter","Swal"],components:{ProductModal:Fe,DeleteModal:ts,ToastList:_s,Pagination:Ts,Loading:Bt},methods:{async checkLogin(){try{this.isLoading=!0;const o=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common.Authorization=o;const e=(await this.axios.post("https://ec-course-api.hexschool.io//v2/api/user/check")).data;this.isLoading=!1,e.success?this.getProducts(1):this.$router.push({name:"member"})}catch(o){this.isLoading=!1,console.log(o),this.$router.push({name:"member"})}},async getProducts(o=1){try{this.isLoading=!0;const e=(await this.axios.get(`${J}v2/api/${G}/admin/products?page=${o}`)).data;e.success?(this.Swal.fire({title:"已取得產品列表!",icon:"success",showConfirmButton:!1,timer:1500}),this.products=e.products,this.pagination=e.pagination):this.Swal.fire({title:"Error!",icon:"error",showConfirmButton:!1,timer:1500}),this.isLoading=!1}catch(e){console.log(e.response),this.isLoading=!1,this.Swal.fire({title:"Error!",icon:"error",showConfirmButton:!1,timer:1500}),this.$router.push({name:"member"})}},async postProduct(o){try{this.$refs.productModal.hideModal(),this.isLoading=!0;const e=(await this.axios.post(`${J}v2/api/${G}/admin/product`,{data:o})).data;this.isLoading=!1,e.success?(this.Swal.fire({title:e.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):this.Swal.fire({title:e.message,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}catch(e){this.isLoading=!1,console.log(e.response),this.Swal.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}},async pathProduct(o){try{this.$refs.productModal.hideModal(),this.isLoading=!0;const e=o.id,i=(await this.axios.put(`${J}v2/api/${G}/admin/product/${e}`,{data:o})).data;this.isLoading=!1,i.success?(this.Swal.fire({title:i.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):this.Swal.fire({title:i.message,icon:"error",showConfirmButton:!1,timer:1500}),console.log(i),this.tempProduct={}}catch(e){this.isLoading=!1,console.log(e.response),this.Swal.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}},async deleteProduct(o){try{this.$refs.deleteModal.hideModal(),this.isLoading=!0;const e=(await this.axios.delete(`${J}v2/api/${G}/admin/product/${o.id}`)).data;this.isLoading=!1,e.success?(this.Swal.fire({title:e.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):this.Swal.fire({title:e.message,icon:"error",showConfirmButton:!1,timer:1500})}catch(e){this.isLoading=!1,console.log(e.response),this.Swal.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500})}},openAddProductModal(){this.tempProduct={imageUrl:"",imagesUrl:[]},this.$refs.productModal.showModal()},openEditProductModal(o){this.tempProduct=o,this.$refs.productModal.showModal()},deleteProductModal(o){this.tempProduct=o,this.$refs.deleteModal.showModal()},hideModal(){this.tempProduct={}},successToast(){this.emitter.emit("push-message",{style:"success",title:"更新成功"})},errorToast(){this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:"更新失敗內容"})}},mounted(){this.checkLogin()}},Cs=t("h1",{class:"text-center text-primary"},"Products List",-1),Ms={class:"text-end"},Ss={class:"table-dark table table-hover mt-4"},Ns=t("thead",null,[t("tr",{class:"line-height-60"},[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{class:"text-center",width:"120"},"原價"),t("th",{class:"text-center",width:"120"},"售價"),t("th",{class:"text-center",width:"100"},"是否啟用"),t("th",{class:"text-center",width:"210"},"編輯")])],-1),Os={class:"text-end"},Ds={class:"text-end"},Ls={class:"text-center"},Vs={key:0,class:"text-success"},Is={key:1,class:"text-secondary"},Us=["onClick"],$s=["onClick"];function Bs(o,e,i,n,s,l){const r=L("Loading"),m=L("ToastList"),h=L("Pagination"),b=L("ProductModal"),k=L("DeleteModal");return p(),f(R,null,[P(r,{"prop-boolean":s.isLoading},null,8,["prop-boolean"]),P(m),Cs,t("div",Ms,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...c)=>l.openAddProductModal&&l.openAddProductModal(...c))},"增加產品")]),t("table",Ss,[Ns,t("tbody",null,[(p(!0),f(R,null,X(s.products,c=>(p(),f("tr",{class:"line-height-60",key:c.id},[t("td",null,S(c.category),1),t("td",null,S(c.title),1),t("td",Os,S(o.$filters.thousands(c.origin_price)),1),t("td",Ds,S(o.$filters.thousands(c.price)),1),t("td",Ls,[c.is_enabled?(p(),f("span",Vs,"啟用")):(p(),f("span",Is,"未啟用"))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:a=>l.openEditProductModal(c)},"編輯",8,Us),t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:a=>l.deleteProductModal(c)},"刪除",8,$s)])]))),128))])]),s.pagination.total_pages?(p(),_t(h,{key:0,"prop-pagination-obj":s.pagination,onEmitPage:l.getProducts},null,8,["prop-pagination-obj","onEmitPage"])):V("",!0),P(b,{ref:"productModal",product:s.tempProduct,"edit-product":s.tempProduct,onEmitPostProduct:l.postProduct,onEmitPathProduct:l.pathProduct,onEmitHideModal:l.hideModal},null,8,["product","edit-product","onEmitPostProduct","onEmitPathProduct","onEmitHideModal"]),P(k,{ref:"deleteModal",product:s.tempProduct,onEmitHideModal:l.hideModal,onEmitDeleteProduct:l.deleteProduct},null,8,["product","onEmitHideModal","onEmitDeleteProduct"])],64)}const Rs=j(xs,[["render",Bs]]);export{Rs as default};
