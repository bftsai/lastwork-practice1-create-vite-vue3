import{S as C}from"./sweetalert2-0WhR_hB3.js";import{e as R,f as ct,g as W,h as B,i as G,j as xt,k as ut,l as mt,_ as j,o as A,c as T,a as E,w as Z,b as t,m as K,n as D,p as S,F as ot,q as ht,s as tt,v as nt,t as kt,r as O,u as I}from"./index-_1f98PDL.js";import{d as H,s as Mt,c as Ct,l as Nt,z as St,F as Dt,a as Lt,E as Vt,r as Ot,e as It,i as Ut,b as $t}from"./zh_TW-CQ7pAcn_.js";import{L as Bt}from"./Loading-5F5Xc1ih.js";var _t={exports:{}},et={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var at;function qt(){return at||(at=1,function(i,e){(function(r,o){i.exports=o(R(),ct(),W())})(B,function(r,o,s){const d="backdrop",m="fade",c="show",h=`mousedown.bs.${d}`,g={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},p={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class u extends o{constructor(a){super(),this._config=this._getConfig(a),this._isAppended=!1,this._element=null}static get Default(){return g}static get DefaultType(){return p}static get NAME(){return d}show(a){if(!this._config.isVisible){s.execute(a);return}this._append();const y=this._getElement();this._config.isAnimated&&s.reflow(y),y.classList.add(c),this._emulateAnimation(()=>{s.execute(a)})}hide(a){if(!this._config.isVisible){s.execute(a);return}this._getElement().classList.remove(c),this._emulateAnimation(()=>{this.dispose(),s.execute(a)})}dispose(){this._isAppended&&(r.off(this._element,h),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const a=document.createElement("div");a.className=this._config.className,this._config.isAnimated&&a.classList.add(m),this._element=a}return this._element}_configAfterMerge(a){return a.rootElement=s.getElement(a.rootElement),a}_append(){if(this._isAppended)return;const a=this._getElement();this._config.rootElement.append(a),r.on(a,h,()=>{s.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(a){s.executeAfterTransition(a,this._getElement(),this._config.isAnimated)}}return u})}(et)),et.exports}var Y={exports:{}};/*!
  * Bootstrap component-functions.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var lt;function pt(){return lt||(lt=1,function(i,e){(function(r,o){o(e,R(),G(),W())})(B,function(r,o,s,d){const m=(c,h="hide")=>{const g=`click.dismiss${c.EVENT_KEY}`,p=c.NAME;o.on(document,g,`[data-bs-dismiss="${p}"]`,function(u){if(["A","AREA"].includes(this.tagName)&&u.preventDefault(),d.isDisabled(this))return;const n=s.getElementFromSelector(this)||this.closest(`.${p}`);c.getOrCreateInstance(n)[h]()})};r.enableDismissTrigger=m,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})}(Y,Y.exports)),Y.exports}var st={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var rt;function Ft(){return rt||(rt=1,function(i,e){(function(r,o){i.exports=o(R(),G(),ct())})(B,function(r,o,s){const d="focustrap",c=".bs.focustrap",h=`focusin${c}`,g=`keydown.tab${c}`,p="Tab",u="forward",n="backward",a={autofocus:!0,trapElement:null},y={autofocus:"boolean",trapElement:"element"};class x extends s{constructor(b){super(),this._config=this._getConfig(b),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return a}static get DefaultType(){return y}static get NAME(){return d}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),r.off(document,c),r.on(document,h,b=>this._handleFocusin(b)),r.on(document,g,b=>this._handleKeydown(b)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,r.off(document,c))}_handleFocusin(b){const{trapElement:M}=this._config;if(b.target===document||b.target===M||M.contains(b.target))return;const w=o.focusableChildren(M);w.length===0?M.focus():this._lastTabNavDirection===n?w[w.length-1].focus():w[0].focus()}_handleKeydown(b){b.key===p&&(this._lastTabNavDirection=b.shiftKey?n:u)}}return x})}(st)),st.exports}var it={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var dt;function Rt(){return dt||(dt=1,function(i,e){(function(r,o){i.exports=o(xt(),G(),W())})(B,function(r,o,s){const d=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",m=".sticky-top",c="padding-right",h="margin-right";class g{constructor(){this._element=document.body}getWidth(){const u=document.documentElement.clientWidth;return Math.abs(window.innerWidth-u)}hide(){const u=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,c,n=>n+u),this._setElementAttributes(d,c,n=>n+u),this._setElementAttributes(m,h,n=>n-u)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,c),this._resetElementAttributes(d,c),this._resetElementAttributes(m,h)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(u,n,a){const y=this.getWidth(),x=k=>{if(k!==this._element&&window.innerWidth>k.clientWidth+y)return;this._saveInitialAttribute(k,n);const b=window.getComputedStyle(k).getPropertyValue(n);k.style.setProperty(n,`${a(Number.parseFloat(b))}px`)};this._applyManipulationCallback(u,x)}_saveInitialAttribute(u,n){const a=u.style.getPropertyValue(n);a&&r.setDataAttribute(u,n,a)}_resetElementAttributes(u,n){const a=y=>{const x=r.getDataAttribute(y,n);if(x===null){y.style.removeProperty(n);return}r.removeDataAttribute(y,n),y.style.setProperty(n,x)};this._applyManipulationCallback(u,a)}_applyManipulationCallback(u,n){if(s.isElement(u)){n(u);return}for(const a of o.find(u,this._element))n(a)}}return g})}(it)),it.exports}/*!
  * Bootstrap modal.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(i,e){(function(r,o){i.exports=o(ut(),R(),G(),qt(),pt(),Ft(),W(),Rt())})(B,function(r,o,s,d,m,c,h,g){const p="modal",n=".bs.modal",a=".data-api",y="Escape",x=`hide${n}`,k=`hidePrevented${n}`,b=`hidden${n}`,M=`show${n}`,w=`shown${n}`,L=`resize${n}`,U=`click.dismiss${n}`,$=`mousedown.dismiss${n}`,l=`keydown.dismiss${n}`,Q=`click${n}${a}`,f="modal-open",P="fade",q="show",X="modal-static",Et=".modal.show",yt=".modal-dialog",vt=".modal-body",wt='[data-bs-toggle="modal"]',Pt={backdrop:!0,focus:!0,keyboard:!0},At={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class V extends r{constructor(_,v){super(_,v),this._dialog=s.findOne(yt,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new g,this._addEventListeners()}static get Default(){return Pt}static get DefaultType(){return At}static get NAME(){return p}toggle(_){return this._isShown?this.hide():this.show(_)}show(_){this._isShown||this._isTransitioning||o.trigger(this._element,M,{relatedTarget:_}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(f),this._adjustDialog(),this._backdrop.show(()=>this._showElement(_)))}hide(){!this._isShown||this._isTransitioning||o.trigger(this._element,x).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(q),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){o.off(window,n),o.off(this._dialog,n),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new d({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new c({trapElement:this._element})}_showElement(_){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const v=s.findOne(vt,this._dialog);v&&(v.scrollTop=0),h.reflow(this._element),this._element.classList.add(q);const N=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,o.trigger(this._element,w,{relatedTarget:_})};this._queueCallback(N,this._dialog,this._isAnimated())}_addEventListeners(){o.on(this._element,l,_=>{if(_.key===y){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),o.on(window,L,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),o.on(this._element,$,_=>{o.one(this._element,U,v=>{if(!(this._element!==_.target||this._element!==v.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(f),this._resetAdjustments(),this._scrollBar.reset(),o.trigger(this._element,b)})}_isAnimated(){return this._element.classList.contains(P)}_triggerBackdropTransition(){if(o.trigger(this._element,k).defaultPrevented)return;const v=this._element.scrollHeight>document.documentElement.clientHeight,N=this._element.style.overflowY;N==="hidden"||this._element.classList.contains(X)||(v||(this._element.style.overflowY="hidden"),this._element.classList.add(X),this._queueCallback(()=>{this._element.classList.remove(X),this._queueCallback(()=>{this._element.style.overflowY=N},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const _=this._element.scrollHeight>document.documentElement.clientHeight,v=this._scrollBar.getWidth(),N=v>0;if(N&&!_){const F=h.isRTL()?"paddingLeft":"paddingRight";this._element.style[F]=`${v}px`}if(!N&&_){const F=h.isRTL()?"paddingRight":"paddingLeft";this._element.style[F]=`${v}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(_,v){return this.each(function(){const N=V.getOrCreateInstance(this,_);if(typeof _=="string"){if(typeof N[_]>"u")throw new TypeError(`No method named "${_}"`);N[_](v)}})}}return o.on(document,Q,wt,function(Tt){const _=s.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&Tt.preventDefault(),o.one(_,M,F=>{F.defaultPrevented||o.one(_,b,()=>{h.isVisible(this)&&this.focus()})});const v=s.findOne(Et);v&&V.getInstance(v).hide(),V.getOrCreateInstance(_).toggle(this)}),m.enableDismissTrigger(V),h.defineJQueryPlugin(V),V})})(_t);var Wt=_t.exports;const Kt=mt(Wt),ft={methods:{showModal(){const i=new Kt(this.$refs.modal,{keyboard:!1});this.modal=i,this.modal.show()},hideModal(){this.tempProduct={},this.$emit("emit-hideModal"),this.modal.hide()}}},gt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20style='margin:%20auto;%20background-image:%20none;%20display:%20block;%20shape-rendering:%20auto;'%20width='50px'%20height='50px'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%3e%3ccircle%20cx='50'%20cy='50'%20r='32'%20stroke-width='8'%20stroke='%23fe718d'%20stroke-dasharray='50.26548245743669%2050.26548245743669'%20fill='none'%20stroke-linecap='round'%3e%3canimateTransform%20attributeName='transform'%20type='rotate'%20repeatCount='indefinite'%20dur='1s'%20keyTimes='0;1'%20values='0%2050%2050;360%2050%2050'%3e%3c/animateTransform%3e%3c/circle%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io/%20--%3e%3c/svg%3e",Yt="https://ec-course-api.hexschool.io/",zt="bftsai";H("required",Ot);H("email",It);H("integer",Ut);H("regex",$t);Mt("zh_TW");Ct({generateMessage:Nt({zh_TW:St}),validateOnInput:!0});const Jt={data(){return{modal:{},tempProduct:{},imageUrl:"",loading:!1}},props:{product:{type:Object,default(){return{}}},editProduct:{type:Object,default(){return{}}}},components:{VForm:Dt,VField:Lt,ErrorMessage:Vt},mixins:[ft],watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product)),this.imageUrl="";const i=document.querySelector("#imageUpload");i.value=""},editProduct(){this.tempProduct=JSON.parse(JSON.stringify(this.editProduct))}},methods:{isImage(){var i;return this.tempProduct.imageUrl&&((i=this.tempProduct)==null?void 0:i.imagesUrl.length)>=1?!0:"請至少新增兩張產品圖片"},async getImageUrl(i){try{this.loading=!0;const e=i.target.files[0],r=new FormData;r.append("file-to-upload",e);const o=(await this.axios.post(`${Yt}v2/api/${zt}/admin/upload`,r)).data;o.success&&(this.imageUrl=o.imageUrl),this.loading=!1}catch(e){console.log(e.response),this.loading=!1}},addImage(){this.tempProduct.imageUrl?this.tempProduct.imagesUrl.push(this.imageUrl):this.tempProduct.imageUrl=this.imageUrl,this.imageUrl=""},sendProduct(){var i;try{(i=this.tempProduct)!=null&&i.id?(this.tempProduct.is_enabled!==!0&&!this.tempProduct.is_enabled?this.tempProduct.is_enabled=0:this.tempProduct.is_enabled===!0&&(this.tempProduct.is_enabled=1),console.log("path",this.tempProduct),this.$emit("emit-path-product",this.tempProduct)):(this.tempProduct.is_enabled===!0?this.tempProduct.is_enabled=1:this.tempProduct.is_enabled=0,console.log("new",this.tempProduct),this.$emit("emit-post-product",this.tempProduct)),this.tempProduct={}}catch(e){console.log(e)}}},mounted(){}},Gt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static","data-bs-keyboard":"false"},jt={class:"modal-content border-0"},Ht={class:"modal-header"},Qt=t("h5",{class:"modal-title fs-md-4 fs-6 fw-bold"},"新增產品",-1),Xt={class:"modal-body"},Zt={class:"row"},te={class:"col-sm-4"},ee={key:0,class:"mb-3"},se=["src"],ie={class:"mb-3"},oe={for:"imageInput",class:"d-flex flex-column"},ne={class:"mb-3"},ae={for:"imageUpload",class:"d-flex flex-column"},le={class:"d-flex align-items-center"},re=["disabled"],de={key:0,src:gt,alt:"loading"},ce={key:1,class:"mb-3"},ue=["src"],me=["src"],he={class:"col-sm-8"},_e={class:"mb-3"},pe={for:"title",class:"d-flex flex-column"},fe={class:"row"},ge={class:"col-sm-6"},be={class:"mb-3"},Ee={for:"category",class:"d-flex flex-column"},ye={class:"col-sm-6"},ve={class:"mb-3"},we={for:"unit",class:"d-flex flex-column"},Pe={class:"row"},Ae={class:"col-sm-6"},Te={class:"mb-3"},xe={for:"origin_price",class:"d-flex flex-column"},ke={class:"col-sm-6"},Me={class:"mb-3"},Ce={for:"price",class:"d-flex flex-column"},Ne={class:"mb-3"},Se={for:"description",class:"d-flex flex-column"},De={class:"mb-3"},Le={for:"content",class:"d-flex flex-column"},Ve={class:"mb-3"},Oe={for:"is_enabled",class:"d-flex align-items-center"},Ie=["checked"],Ue={class:"modal-footer"},$e=t("button",{type:"submit",class:"btn btn-primary"},"Save changes",-1);function Be(i,e,r,o,s,d){const m=O("v-field"),c=O("error-message"),h=O("v-form");return A(),T("div",Gt,[E(h,{class:"modal-dialog modal-xl",onSubmit:d.sendProduct,novalidate:""},{default:Z(({errors:g})=>{var p,u,n,a,y,x,k,b,M,w,L,U,$;return[t("div",jt,[t("div",Ht,[Qt,t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...l)=>i.hideModal&&i.hideModal(...l))},"X")]),t("div",Xt,[t("div",Zt,[t("div",te,[s.imageUrl?(A(),T("div",ee,[t("img",{src:s.imageUrl,alt:"主圖照片",class:"object-fit-cover w-100"},null,8,se)])):K("",!0),t("div",ie,[t("label",oe,[D(" 輸入圖片網址 "),E(m,{name:"image",class:S({"is-invalid":g.image}),id:"imageInput",type:"text",placeholder:"請輸入圖片連結",modelValue:s.imageUrl,"onUpdate:modelValue":e[1]||(e[1]=l=>s.imageUrl=l),disabled:((u=(p=s.tempProduct)==null?void 0:p.imagesUrl)==null?void 0:u.length)>=5,rules:d.isImage},null,8,["class","modelValue","disabled","rules"]),E(c,{name:"image",class:"invalid-feedback"}),t("span",{class:S(["text-danger",{"d-none":((a=(n=s.tempProduct)==null?void 0:n.imagesUrl)==null?void 0:a.length)!==5}])},"上傳照片數量已滿",2)])]),t("div",ne,[t("label",ae,[D(" 或 上傳圖片 "),t("div",le,[t("input",{id:"imageUpload",type:"file",disabled:((x=(y=s.tempProduct)==null?void 0:y.imagesUrl)==null?void 0:x.length)>=5,onChange:e[2]||(e[2]=(...l)=>d.getImageUrl&&d.getImageUrl(...l))},null,40,re),s.loading?(A(),T("img",de)):K("",!0)]),t("span",{class:S(["text-danger",{"d-none":((b=(k=s.tempProduct)==null?void 0:k.imagesUrl)==null?void 0:b.length)!==5}])},"上傳照片數量已滿",2)])]),s.tempProduct.imageUrl?(A(),T("div",ce,[(M=s.tempProduct)!=null&&M.imageUrl?(A(),T("img",{key:0,class:"w-45 me-3 mb-3",src:(w=s.tempProduct)==null?void 0:w.imageUrl,alt:""},null,8,ue)):K("",!0),(A(!0),T(ot,null,ht(s.tempProduct.imagesUrl,(l,Q)=>(A(),T("img",{src:l,alt:"附圖 key",key:"key"+Q,class:"w-45 me-3"},null,8,me))),128))])):K("",!0),t("button",{type:"button",class:S(["btn btn-outline-primary w-100",{disabled:((U=(L=s.tempProduct)==null?void 0:L.imagesUrl)==null?void 0:U.length)===5}]),onClick:e[3]||(e[3]=(...l)=>d.addImage&&d.addImage(...l))},"新增圖片",2)]),t("div",he,[t("div",_e,[t("label",pe,[D(" 標題 "),E(m,{name:"標題",class:S({"is-invalid":g.標題}),id:"title",type:"text",placeholder:"請輸入標題",modelValue:s.tempProduct.title,"onUpdate:modelValue":e[4]||(e[4]=l=>s.tempProduct.title=l),rules:"required"},null,8,["class","modelValue"]),E(c,{name:"標題",class:"invalid-feedback"})])]),t("div",fe,[t("div",ge,[t("div",be,[t("label",Ee,[D(" 分類 "),E(m,{name:"分類",class:S({"is-invalid":g.分類}),id:"category",type:"text",placeholder:"請輸入分類",modelValue:s.tempProduct.category,"onUpdate:modelValue":e[5]||(e[5]=l=>s.tempProduct.category=l),rules:"required"},null,8,["class","modelValue"]),E(c,{name:"分類",class:"invalid-feedback"})])])]),t("div",ye,[t("div",ve,[t("label",we,[D(" 單位 "),E(m,{name:"單位",class:S({"is-invalid":g.單位}),id:"unit",type:"text",placeholder:"請輸入單位",modelValue:s.tempProduct.unit,"onUpdate:modelValue":e[6]||(e[6]=l=>s.tempProduct.unit=l),rules:"required"},null,8,["class","modelValue"]),E(c,{name:"單位",class:"invalid-feedback"})])])])]),t("div",Pe,[t("div",Ae,[t("div",Te,[t("label",xe,[D(" 原價 "),E(m,{name:"原價",class:S({"is-invalid":g.原價}),id:"origin_price",type:"number",placeholder:"請輸入原價",modelValue:s.tempProduct.origin_price,"onUpdate:modelValue":e[7]||(e[7]=l=>s.tempProduct.origin_price=l),rules:"required|integer"},null,8,["class","modelValue"]),E(c,{name:"原價",class:"invalid-feedback"})])])]),t("div",ke,[t("div",Me,[t("label",Ce,[D(" 售價 "),E(m,{name:"售價",class:S({"is-invalid":g.售價}),id:"price",type:"number",placeholder:"請輸入售價",modelValue:s.tempProduct.price,"onUpdate:modelValue":e[8]||(e[8]=l=>s.tempProduct.price=l),rules:"required|integer"},null,8,["class","modelValue"]),E(c,{name:"售價",class:"invalid-feedback"})])])])]),t("div",Ne,[t("label",Se,[D(" 產品描述 "),E(m,{name:"產品描述",rules:"required",modelValue:s.tempProduct.description,"onUpdate:modelValue":e[10]||(e[10]=l=>s.tempProduct.description=l)},{default:Z(()=>[tt(t("textarea",{name:"產品描述",class:S({"is-invalid":g.產品描述}),id:"description",cols:"30",rows:"3",placeholder:"請輸入產品描述","onUpdate:modelValue":e[9]||(e[9]=l=>s.tempProduct.description=l)},null,2),[[nt,s.tempProduct.description]]),E(c,{name:"產品描述",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",De,[t("label",Le,[D(" 說明內容 "),E(m,{name:"說明內容",rules:"required",modelValue:s.tempProduct.content,"onUpdate:modelValue":e[12]||(e[12]=l=>s.tempProduct.content=l)},{default:Z(()=>[tt(t("textarea",{name:"content",class:S({"is-invalid":g.說明內容}),id:"content",cols:"30",rows:"3",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[11]||(e[11]=l=>s.tempProduct.content=l)},null,2),[[nt,s.tempProduct.content]]),E(c,{name:"說明內容",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",Ve,[t("label",Oe,[tt(t("input",{type:"checkbox",name:"is_enabled",id:"is_enabled",class:"me-2",checked:($=s.tempProduct)==null?void 0:$.is_enabled,"onUpdate:modelValue":e[13]||(e[13]=l=>s.tempProduct.is_enabled=l)},null,8,Ie),[[kt,s.tempProduct.is_enabled]]),D(" 是否啟用 ")])])])])]),t("div",Ue,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[14]||(e[14]=(...l)=>i.hideModal&&i.hideModal(...l))},"Close"),$e])])]}),_:1},8,["onSubmit"])],512)}const qe=j(Jt,[["render",Be]]),Fe={data(){return{tempProduct:{}}},mixins:[ft],props:{product:{type:Object,default(){return{}}}},watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},methods:{sendProduct(){this.$emit("emit-deleteProduct",this.tempProduct),this.tempProduct={}}}},Re={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static","data-bs-keyboard":"false"},We={class:"modal-dialog"},Ke={class:"modal-content"},Ye={class:"modal-header"},ze=t("h5",{class:"modal-title fs-md-4 fs-6 fw-bold text-danger"},"Delete Product",-1),Je={class:"modal-body d-flex flex-column"},Ge=t("h2",{class:"fs-md-5 fs-6 mb-3"},"是否要刪除此商品？",-1),je=t("h3",{class:"fs-6"},"商品資訊：",-1),He=["src"],Qe={class:"modal-footer"};function Xe(i,e,r,o,s,d){return A(),T("div",Re,[t("div",We,[t("div",Ke,[t("div",Ye,[ze,t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...m)=>i.hideModal&&i.hideModal(...m))},"X")]),t("div",Je,[Ge,je,t("p",null,"ID："+I(s.tempProduct.id),1),t("p",null,"Title："+I(s.tempProduct.title),1),t("p",null,"Category："+I(s.tempProduct.category),1),t("img",{src:s.tempProduct.imageUrl,alt:"商品圖片",class:"w-50 align-self-center object-fit-cover"},null,8,He)]),t("div",Qe,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=(...m)=>i.hideModal&&i.hideModal(...m))},"Close"),t("button",{type:"button",class:"btn btn-danger text-primary",onClick:e[2]||(e[2]=(...m)=>d.sendProduct&&d.sendProduct(...m))},"Delete Product")])])])],512)}const Ze=j(Fe,[["render",Xe]]);var bt={exports:{}};/*!
  * Bootstrap toast.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(i,e){(function(r,o){i.exports=o(ut(),R(),pt(),W())})(B,function(r,o,s,d){const m="toast",h=".bs.toast",g=`mouseover${h}`,p=`mouseout${h}`,u=`focusin${h}`,n=`focusout${h}`,a=`hide${h}`,y=`hidden${h}`,x=`show${h}`,k=`shown${h}`,b="fade",M="hide",w="show",L="showing",U={animation:"boolean",autohide:"boolean",delay:"number"},$={animation:!0,autohide:!0,delay:5e3};class l extends r{constructor(f,P){super(f,P),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return $}static get DefaultType(){return U}static get NAME(){return m}show(){if(o.trigger(this._element,x).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(b);const P=()=>{this._element.classList.remove(L),o.trigger(this._element,k),this._maybeScheduleHide()};this._element.classList.remove(M),d.reflow(this._element),this._element.classList.add(w,L),this._queueCallback(P,this._element,this._config.animation)}hide(){if(!this.isShown()||o.trigger(this._element,a).defaultPrevented)return;const P=()=>{this._element.classList.add(M),this._element.classList.remove(L,w),o.trigger(this._element,y)};this._element.classList.add(L),this._queueCallback(P,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(w),super.dispose()}isShown(){return this._element.classList.contains(w)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(f,P){switch(f.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=P;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=P;break}}if(P){this._clearTimeout();return}const q=f.relatedTarget;this._element===q||this._element.contains(q)||this._maybeScheduleHide()}_setListeners(){o.on(this._element,g,f=>this._onInteraction(f,!0)),o.on(this._element,p,f=>this._onInteraction(f,!1)),o.on(this._element,u,f=>this._onInteraction(f,!0)),o.on(this._element,n,f=>this._onInteraction(f,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(f){return this.each(function(){const P=l.getOrCreateInstance(this,f);if(typeof f=="string"){if(typeof P[f]>"u")throw new TypeError(`No method named "${f}"`);P[f](this)}})}}return s.enableDismissTrigger(l),d.defineJQueryPlugin(l),l})})(bt);var ts=bt.exports;const es=mt(ts),ss={data(){return{}},methods:{init(){[...document.querySelectorAll(".toast")].map(e=>new es(e,{animation:!0,autohide:!0,delay:400}))},showToast(){},hideToast(){}},mounted(){this.init()}},is={class:"toast-container position-fixed bottom-0 end-0 p-3 bg-dark"},os=t("div",{id:"liveToast",class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},[t("div",{class:"toast-header"},[t("img",{src:gt,class:"rounded me-2",alt:"..."}),t("strong",{class:"me-auto"},"Bootstrap"),t("small",null,"11 mins ago"),t("button",{type:"button",class:"btn btn-close","data-bs-dismiss":"toast","aria-label":"Close"},"X")]),t("div",{class:"toast-body"}," Hello, world! This is a toast message. ")],-1),ns=[os];function as(i,e,r,o,s,d){return A(),T("div",is,ns)}const ls=j(ss,[["render",as]]),z="https://ec-course-api.hexschool.io/",J="bftsai",rs={data(){return{products:[],pagination:{},tempProduct:{},isLoading:!1}},components:{ProductModal:qe,DeleteModal:Ze,Toast:ls,Loading:Bt},methods:{async checkLogin(){try{this.isLoading=!0;const i=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common.Authorization=i;const e=(await this.axios.post("https://ec-course-api.hexschool.io//v2/api/user/check")).data;this.isLoading=!1,e.success?this.getProducts(1):(C.fire({icon:"error",title:`${e.message}`,showConfirmButton:!1,timer:800}),this.logout(),this.$router.push({name:"member"}))}catch(i){console.log(i),this.$router.push({name:"member"}),this.isLoading=!1}},async getProducts(i){try{this.isLoading=!0;const e=(await this.axios.get(`${z}v2/api/${J}/admin/products?page=${i}`)).data;e.success?(C.fire({title:"已取得產品列表!",icon:"success",showConfirmButton:!1,timer:1500}),this.products=e.products,this.pagination=e.pagination):C.fire({title:"Error!",icon:"error",showConfirmButton:!1,timer:1500}),this.isLoading=!1,console.log(this.products,this.pagination)}catch(e){console.log(e.response),this.isLoading=!1,C.fire({title:"Error!",icon:"error",showConfirmButton:!1,timer:1500}),this.$router.push({name:"member"})}},async postProduct(i){try{this.$refs.productModal.hideModal(),this.isLoading=!0;const e=(await this.axios.post(`${z}v2/api/${J}/admin/product`,{data:i})).data;this.isLoading=!1,e.success?(C.fire({title:e.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):C.fire({title:e.message,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}catch(e){this.isLoading=!1,console.log(e.response),C.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}},async pathProduct(i){try{this.$refs.productModal.hideModal(),this.isLoading=!0;const e=i.id,r=(await this.axios.put(`${z}v2/api/${J}/admin/product/${e}`,{data:i})).data;this.isLoading=!1,r.success?(C.fire({title:r.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):C.fire({title:r.message,icon:"error",showConfirmButton:!1,timer:1500}),console.log(r),this.tempProduct={}}catch(e){this.isLoading=!1,console.log(e.response),C.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500}),this.tempProduct={}}},async deleteProduct(i){try{this.$refs.deleteModal.hideModal(),this.isLoading=!0;const e=(await this.axios.delete(`${z}v2/api/${J}/admin/product/${i.id}`)).data;this.isLoading=!1,e.success?(C.fire({title:e.message,icon:"success",showConfirmButton:!1,timer:1500}),this.getProducts(1)):C.fire({title:e.message,icon:"error",showConfirmButton:!1,timer:1500})}catch(e){this.isLoading=!1,console.log(e.response),C.fire({title:e.response,icon:"error",showConfirmButton:!1,timer:1500})}},openAddProductModal(){this.tempProduct={imageUrl:"",imagesUrl:[]},this.$refs.productModal.showModal()},openEditProductModal(i){this.tempProduct=i,this.$refs.productModal.showModal()},deleteProductModal(i){this.tempProduct=i,this.$refs.deleteModal.showModal()},hideModal(){this.tempProduct={}}},created(){},mounted(){this.checkLogin()}},ds=t("h1",null,"Products List",-1),cs={class:"text-end"},us={class:"table-dark table table-hover mt-4"},ms=t("thead",null,[t("tr",{class:"line-height-60"},[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{class:"text-center",width:"120"},"原價"),t("th",{class:"text-center",width:"120"},"售價"),t("th",{class:"text-center",width:"100"},"是否啟用"),t("th",{class:"text-center",width:"210"},"編輯")])],-1),hs={class:"text-end"},_s={class:"text-end"},ps={class:"text-center"},fs={key:0,class:"text-success"},gs={key:1,class:"text-secondary"},bs=["onClick"],Es=["onClick"];function ys(i,e,r,o,s,d){const m=O("Loading"),c=O("Toast"),h=O("ProductModal"),g=O("DeleteModal");return A(),T(ot,null,[E(m,{"prop-boolean":s.isLoading},null,8,["prop-boolean"]),E(c),ds,t("div",cs,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...p)=>d.openAddProductModal&&d.openAddProductModal(...p))},"增加產品")]),t("table",us,[ms,t("tbody",null,[(A(!0),T(ot,null,ht(s.products,p=>(A(),T("tr",{class:"line-height-60",key:p.id},[t("td",null,I(p.category),1),t("td",null,I(p.title),1),t("td",hs,I(p.origin_price),1),t("td",_s,I(p.price),1),t("td",ps,[p.is_enabled?(A(),T("span",fs,"啟用")):(A(),T("span",gs,"未啟用"))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:u=>d.openEditProductModal(p)},"編輯",8,bs),t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:u=>d.deleteProductModal(p)},"刪除",8,Es)])]))),128))])]),E(h,{ref:"productModal",product:s.tempProduct,"edit-product":s.tempProduct,onEmitPostProduct:d.postProduct,onEmitPathProduct:d.pathProduct,onEmitHideModal:d.hideModal},null,8,["product","edit-product","onEmitPostProduct","onEmitPathProduct","onEmitHideModal"]),E(g,{ref:"deleteModal",product:s.tempProduct,onEmitHideModal:d.hideModal,onEmitDeleteProduct:d.deleteProduct},null,8,["product","onEmitHideModal","onEmitDeleteProduct"])],64)}const Ts=j(rs,[["render",ys]]);export{Ts as default};
